{% extends 'hobro/base.html' %}
{% load itemviews %}


{% block content %}
    {% for item in items %}
        {% with a=item.get_type %}
            {% if a == "section" %}
                {% show_section item %}
            {% elif a == "story" %}
                {% show_story item %}
            {% elif a == "post" %}
                {% show_post item %}
            {% elif a == "postphoto" %}
                {% show_postphoto item %}
            {% elif a == "postvideo" %}
                {% show_postvideo item %}
            {% elif a == "profileevent" %}
                {% show_profileevent item %}
            {% elif a == "itemembed" %}
                {% show_itemembed item %}
            {% elif a == "swgrs_post" %}
                {% show_swgrspost item %}
            {% elif a == "swgrs_media" %}
                {% show_swgrsmedia item %}
            {% else %}
                <div class="post">
                    <h2>Indhold kunne ikke findes</h2>
                    <p>{{item}}</p>
                </div>
            {% endif %}
        {% endwith %}
    {% endfor %}
    {% if next %}
        <div class="section is-medium has-background-dark is-raised has-text-centered">
            <a href="{% url 'item_page' number=next %}" class="button alive fade navy-text is-medium is-dark is-inverted is-rounded">Videre til kapitel {{next}}</a>
        </div>
    {% endif %}
<script>
    const alive = document.querySelectorAll('.alive');

    observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.intersectionRatio > 0) {
          //entry.target.classList.add('fancy');
          if (entry.target.classList.contains('right')) {
            Velocity(entry.target, { transform: [ "translateX(0)", "translateX(5%)" ], opacity: [1, 0.3] }, {duration: 400, easing: 'ease-in'} );
          }
          else if (entry.target.classList.contains('left')) {
            Velocity(entry.target, { transform: [ "translateX(0)", "translateX(-5%)" ], opacity: [1, 0.3] }, {duration: 400, easing: 'ease-in'} );
          }
          else if (entry.target.classList.contains('fade')) {
            Velocity(entry.target, { opacity: [1, 0] }, {duration: 500, easing: 'ease-out'} );
          }
          else if (entry.target.classList.contains('slide')) {
            Velocity(entry.target, { transform: [ "translateY(0)", "translateY(8%)" ], opacity: [1, 0] }, {duration: 500, easing: 'ease-in'} );
          }
          else if (entry.target.classList.contains('slide-long')) {
            Velocity(entry.target, { transform: [ "translateY(0)", "translateY(20%)" ], opacity: [1, 0] }, {duration: 600, easing: 'ease-out'} );
          }
          else {
            Velocity(entry.target, { transform: [ "scale(1)", "scale(0.96)" ], opacity: [1, 0.5] }, {duration: 400, easing: 'ease-in'} );
          }
          observer.unobserve(entry.target);
        } else {
          //entry.target.classList.remove('fancy');
        }
      });
    });
    var anim = showAnimations();
    if (anim) {
        alive.forEach(living => {
          observer.observe(living);
        });
    }
</script>
{% endblock %}